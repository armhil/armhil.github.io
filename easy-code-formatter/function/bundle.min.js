var AddinFunctions=function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var o=e.default;if("function"==typeof o){var t=function e(){var t=!1;try{t=this instanceof e}catch{}return t?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};t.prototype=o.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach((function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})})),t}var t={};const n={IsOffice:function(){return!!(window.Office&&window.Office.context&&window.Office.context.document)},IsGsuite:function(){return!!(window.google&&window.google.script&&window.google.script.run)},IsLocalhost:function(){return window.location.hostname.indexOf("localhost")>=0}},l={Initialize:function(e){n.IsLocalhost()?(console.log("AddinUtils.Initialize -> We are in localhost"),null==e||e()):n.IsOffice()?window.Office.onReady((o=>null==e?void 0:e(o))):null==e||e()},InsertText:function(e,o,t){n.IsLocalhost()?console.log("AddinUtils.InsertText invoked with ",e):n.IsGsuite()?window.google.script.run.insertPlainText(e):window.Office.context.document.setSelectedDataAsync(e,{coercionType:window.Office.CoercionType[o]},t)},InsertImage:function(e,o){n.IsOffice()?window.Office.context.document.setSelectedDataAsync(e,{coercionType:window.Office.CoercionType.Image},(function(e){o(e)})):n.IsGsuite()&&window.google.script.run.withSuccessHandler((e=>o(e))).withFailureHandler((e=>console.error(e))).insertImageFromBase64String(e)},GetText:function(e){n.IsOffice()?window.Office.context.document.getSelectedDataAsync(window.Office.CoercionType.Text,(function(o){o.status==window.Office.AsyncResultStatus.Failed?console.error(o.error.message):e(o.value)})):n.IsGsuite()&&window.google.script.run.withSuccessHandler((o=>e(o))).withFailureHandler((e=>console.error(e))).getSelectedText()},SaveSetting:function(e,o){n.IsOffice()?(window.Office.context.document.settings.set(e,o),window.Office.context.document.settings.saveAsync()):n.IsLocalhost()&&(this.localDictionary||(this.localDictionary={}),this.localDictionary[e]=o)},GetSetting:function(e){return n.IsOffice()?window.Office.context.document.settings.get(e):n.IsLocalhost()&&this.localDictionary?this.localDictionary[e]:void 0}},r={Trace:function(e){window.location.hostname.indexOf("localhost")>=0||window.appInsights&&window.appInsights.trackEvent&&window.appInsights.trackEvent({name:e})}};var i=o(Object.freeze({__proto__:null,AddinUtils:l,EnvironmentUtils:n,LoggingUtils:r}));function a(e){if(!e||!Object.keys(e))return"";const o={Color:"color:#",Background:"background:",BackgroundColor:"background-color:",FontWeight:"font-weight:",FontStyle:"font-style:"};return Object.keys(e).reduce(((t,n)=>"BackgroundColor"!==n&&"Background"!==n||"none"===e[n]?`${t}${o[n]}${e[n]};`:`${t}${o[n]}#${e[n]};`),"")}const c={Default:{DisplayName:"Default",CodeStyles:{Keyword:{Color:"008"},Comment:{Color:"800"},Plaintext:{Color:"000"},Punctuation:{Color:"660"},String:{Color:"080"},Literal:{Color:"066"},Type:{Color:"606"}},BackgroundStyle:{},LineNumberStyle:{Background:"none"}},DefaultGray:{DisplayName:"Default (with Gray background)",CodeStyles:{Keyword:{Color:"008"},Comment:{Color:"800"},Plaintext:{Color:"000"},Punctuation:{Color:"660"},String:{Color:"080"},Literal:{Color:"066"},Type:{Color:"606"}},BackgroundStyle:{BackgroundColor:"ececec"},LineNumberStyle:{Background:"none"}},Desert:{DisplayName:"Desert",CodeStyles:{Keyword:{Color:"f0e68c"},Comment:{Color:"87ceeb"},Plaintext:{Color:"fff"},Punctuation:{Color:"fff"},String:{Color:"ffa0a0"},Literal:{Color:"cd5c5c"},Type:{Color:"98fb98"},Tag:{Color:"f0e68c"},AttributeName:{Color:"bdb76b",FontWeight:"bold"},AttributeValue:{Color:"ffa0a0"},Decimal:{Color:"98fb98"},NoCode:{Color:"000",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"333"},LineNumberStyle:{Color:"fff",Background:"none"}},Sunburst:{DisplayName:"Sunburst",CodeStyles:{Keyword:{Color:"e28964"},Comment:{Color:"aeaeae",FontStyle:"italic"},Plaintext:{Color:"fff"},Punctuation:{Color:"fff"},String:{Color:"65b042"},Literal:{Color:"cd5c5c"},Type:{Color:"89bdff"},Tag:{Color:"89bdff"},AttributeName:{Color:"bdb76b"},AttributeValue:{Color:"65b042"},Decimal:{Color:"3387cc"},NoCode:{Color:"000",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"000"},LineNumberStyle:{Color:"fff",Background:"none"}},A11YDark:{DisplayName:"A11YDark",CodeStyles:{Keyword:{Color:"dcc6e0"},Comment:{Color:"d4d0ab"},Plaintext:{Color:"fff"},Punctuation:{Color:"fff"},String:{Color:"abe338"},Literal:{Color:"f5ab35"},Type:{Color:"00e0e0"},Tag:{Color:"00e0e0"},AttributeName:{Color:"ffd700",FontWeight:"bold"},AttributeValue:{Color:"abe338"},Decimal:{Color:"f5ab35"},NoCode:{Color:"000",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"2b2b2b"},LineNumberStyle:{Color:"fff",Background:"none"}},A11YLight:{DisplayName:"A11YLight",CodeStyles:{Keyword:{Color:"7928a1"},Comment:{Color:"696969"},Plaintext:{Color:"545454"},Punctuation:{Color:"545454"},String:{Color:"008000"},Literal:{Color:"aa5d00"},Type:{Color:"007faa"},Tag:{Color:"007faa"},AttributeName:{Color:"aa5d00",FontWeight:"bold"},AttributeValue:{Color:"008000"},Decimal:{Color:"aa5d00"},NoCode:{Color:"000",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"fefefe"},LineNumberStyle:{Color:"000",Background:"none"}},AtelierCaveLight:{DisplayName:"Atelier Cave Light",CodeStyles:{Keyword:{Color:"955ae7"},Comment:{Color:"7e7887"},Plaintext:{Color:"aa573c"},Punctuation:{Color:"8b8792"},String:{Color:"2a9292"},Literal:{Color:"c07156"},Type:{Color:"576ddb"},Tag:{Color:"be4678"},AttributeName:{Color:"759731",FontWeight:"bold"},AttributeValue:{Color:"be4678"},Decimal:{Color:"aa573c"},NoCode:{Color:"576ddb",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"efecf4"},LineNumberStyle:{Color:"aeb0b3",Background:"none"}},AtelierCaveDark:{DisplayName:"Atelier Cave Dark",CodeStyles:{Keyword:{Color:"955ae7"},Comment:{Color:"7e7887"},Plaintext:{Color:"333333"},Punctuation:{Color:"333333"},String:{Color:"2a9292"},Literal:{Color:"c07156"},Type:{Color:"aa573c"},Tag:{Color:"be4678"},AttributeName:{Color:"759731",FontWeight:"bold"},AttributeValue:{Color:"be4678"},Decimal:{Color:"aa573c"},NoCode:{Color:"576ddb",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"19171c"},LineNumberStyle:{Color:"aeb0b3",Background:"none"}},BlueHintGray:{DisplayName:"Blue Hint Gray",CodeStyles:{Keyword:{Color:"0000ff"},Comment:{Color:"008000"},Plaintext:{Color:"000"},Punctuation:{Color:"000"},String:{Color:"a31515"},Literal:{Color:"066"},Type:{Color:"2b91af"},Tag:{Color:"2b91af"}},BackgroundStyle:{BackgroundColor:"eaeaea"},LineNumberStyle:{Background:"none"}},CSharpDark:{DisplayName:"C# Dark",CodeStyles:{Keyword:{Color:"569cd6"},Comment:{Color:"56a64a"},Plaintext:{Color:"dedede"},Punctuation:{Color:"dedede"},String:{Color:"dadada"},Literal:{Color:"dadada"},Type:{Color:"4ec9b0"},Tag:{Color:"d7bb7d"},AttributeName:{Color:"4ec9b0"},AttributeValue:{Color:"569cd6"},Decimal:{Color:"b5cea8"},NoCode:{Color:"000",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"1e1e1e"},LineNumberStyle:{Color:"e0e0e0"}},ChatGPTDark:{DisplayName:"ChatGPT Dark",CodeStyles:{Keyword:{Color:"66ccff",FontWeight:"bold"},Comment:{Color:"888888",FontStyle:"italic"},Plaintext:{Color:"ffffff"},Punctuation:{Color:"ffffff"},String:{Color:"99cc99"},Literal:{Color:"ff99cc"},Type:{Color:"cc99ff"},Tag:{Color:"ff6666"},AttributeName:{Color:"99ff99",FontWeight:"bold"},AttributeValue:{Color:"66ccff"},Decimal:{Color:"ff99cc"},NoCode:{Color:"ffffff",BackgroundColor:"none"}},BackgroundStyle:{BackgroundColor:"2d2e41"},LineNumberStyle:{Color:"777777",Background:"none"}},ThonnyDefaultLight:{DisplayName:"Thonny Default Light",CodeStyles:{Keyword:{Color:"7f0055",FontWeight:"bold"},Comment:{Color:"a9a9a9"},Plaintext:{Color:"000000"},Punctuation:{Color:"000000"},String:{Color:"006400"},Literal:{Color:"b04600"},Type:{Color:"7f0055"}},BackgroundStyle:{},LineNumberStyle:{Background:"none"}}};function s(e){return c[e]?a(c[e].LineNumberStyle):""}function d(e){return c[e]?a(c[e].BackgroundStyle):""}function u(e,o){return c[e]?a(c[e].CodeStyles[o]):""}var f=Object.freeze({__proto__:null,Fonts:["Consolas","Arial","Times New Roman","Helvetica","Times","Courier New","Verdana","Courier","Candara","Geneva","Calibri","Cascadia","Intel"],GetBackgroundStyle:d,GetGenericStyle:u,GetLineNumberStyle:s,Themes:c});function g(e){if(!c[e])throw new Error("Theme doesn't exist");const o={};for(let t=0;t<10;t++)o['class="L'+t+'"']=`style="${s(e)}"`;const t={'class="kwd"':`style="${u(e,"Keyword")}"`,'class="pun"':`style="${u(e,"Punctuation")}"`,'class="pln"':`style="${u(e,"Plaintext")}"`,'class="str"':`style="${u(e,"String")}"`,'class="lit"':`style="${u(e,"Literal")}"`,'class="typ"':`style="${u(e,"Type")}"`,'class="com"':`style="${u(e,"Comment")}"`,'class="tag"':`style="${u(e,"Tag")}"`,'class="atn"':`style="${u(e,"AttributeName")}"`,'class="atv"':`style="${u(e,"AttributeValue")}"`,'class="dec"':`style="${u(e,"Decimal")}"`,'class="nocode"':`style="${u(e,"NoCode")}"`},n={};return Object.keys(o).forEach((function(e){n[e]=o[e]})),Object.keys(t).forEach((function(e){n[e]=t[e]})),n}const C=(e,o,t)=>{const n=`font-family:${o};`,l=`font-size:${t}px;`;return`<p style="margin-top:0px;margin-bottom:0px;${s(e)}${n}${l}">`},y=e=>`<li style="${s(e)}">`,m={CodifyText:function(e,o,t,n,l){e=(e=e.replaceAll(">","&gt;")).replaceAll("<","&lt;");let r=window.PR.prettyPrintOne(e,void 0,!0);const i=g(o);if(Object.keys(i).forEach((function(e){r=r.replaceAll(e,i[e])})),r=r.replaceAll('<ol class="linenums">',"<div>"),r=r.replaceAll("</ol>","</div>"),r=r.replaceAll("</li>","</p>"),l){const e=r.split(y(o)),l=o=>`${" ".repeat((e.length-1).toString().length-o.toString().length)}${o}. `;r=e.map(((e,r)=>0==r?e:`${C(o,t,n)}${l(r)}${e}`)).join("")}else r=r.replaceAll(y(o),C(o,t,n));return'<pre style="padding: 2px;border: 1px solid #888;'+d(o)+'">'+r+"</pre>"},HighlightHtml:function(e,o,t,n=!1){return e=n?o?'<div style="border: 1px solid #'+t+'">'+e+"</div>":'<div style="background: #'+t+'">'+e+"</div>":o?'<span style="border: 1px solid #'+t+'">'+e+"</span>":'<span style="background: #'+t+'">'+e+"</span>"}},S="theme",w="lines",b="color",p="rectangle",h="fontName",T="fontSize",k={InsertText:function(e){n.IsLocalhost()?console.log(">>> AddinUtils.InsertText invoked with ",e):n.IsGsuite()?window.google.script.run.insertPlainText(e):window.Office.context.document.setSelectedDataAsync(e,(function(){}))},GetSavedTheme:function(){return localStorage.getItem(S)||"Default"},SetFontName:function(e){localStorage.setItem(h,e)},GetSavedFontName:function(){return localStorage.getItem(h)||"Consolas"},SetFontSize:function(e){localStorage.setItem(T,e)},GetSavedFontSize:function(){return localStorage.getItem(T)||"11"},SetTheme:function(e){localStorage.setItem(S,e)},GetSavedLineRenderingSetting:function(){const e=localStorage.getItem(w);return null==e||"true"===e},SetLineRenderingSetting:function(e){localStorage.setItem(w,e)},GetSavedColor:function(){return localStorage.getItem(b)||"#39FF14"},SetColor:function(e){localStorage.setItem(b,e)},GetIsRectangle:function(){const e=localStorage.getItem(p);return null!=e&&"true"===e},SetIsRectangle:function(e){localStorage.setItem(p,e)},TryCodifying:function(){r.Trace("ecf-trycodify"),n.IsLocalhost()?console.log("localhost invocation: AddinUtils.TryCodifying invoked"):n.IsGsuite()?window.google.script.run.withFailureHandler((function(e,o){console.log("params from onFailure",e,o)})).withSuccessHandler((function(e){let o=m.CodifyText(e,k.GetSavedTheme(),k.GetSavedFontName(),k.GetSavedFontSize(),k.GetSavedLineRenderingSetting());o=o.replaceAll("&nbsp;",""),window.google.script.run.insertCode(o,!1,k.GetSavedFontName(),k.GetSavedFontSize())})).getSelectedText():window.Office.context.document.getSelectedDataAsync(window.Office.CoercionType.Text,(function(e){if(e.status===window.Office.AsyncResultStatus.Failed)console.log(e.error.message);else{let o=e.value;"\n"!==o[o.length-1]&&(o+="\n\n");const t=m.CodifyText(o,k.GetSavedTheme(),k.GetSavedFontName(),k.GetSavedFontSize(),k.GetSavedLineRenderingSetting());t?window.Office.context.document.setSelectedDataAsync(t,{coercionType:window.Office.CoercionType.Html},(function(e){e.status===window.Office.AsyncResultStatus.Failed&&console.log(e.error.message)})):console.log("Prettified text wasn't found")}}))},TryHighlighting:function(){n.IsLocalhost()?console.log("localhost invocation: AddinUtils.TryHighlighting invoked"):(r.Trace("ecf-tryhighlight"),window.Office.context.document.getSelectedDataAsync(window.Office.CoercionType.Text,(function(e){if(e.status===window.Office.AsyncResultStatus.Failed)console.log("Error in TryHighlighting: ",e.error.message);else{const o=e.value,t=m.CodifyText(o,k.GetSavedTheme(),k.GetSavedFontName(),k.GetSavedFontSize(),!1),n=m.HighlightHtml(t,k.GetIsRectangle(),k.GetSavedColor());n?window.Office.context.document.setSelectedDataAsync(n,{coercionType:window.Office.CoercionType.Html},(function(e){e.status===window.Office.AsyncResultStatus.Failed&&console.log(e.error.message)})):console.log("Prettified text wasn't found")}})))}};var v,A=o(Object.freeze({__proto__:null,AddinUtils:k,CodeUtils:m,GetTheme:g,LISTITEM_STYLING:y,PARAGRAPH_STYLING:C})),x=o(f);return e(function(){if(v)return t;v=1,t.__esModule=!0,t.HighlightHtml=t.CodifyText=void 0;var e=i,o=A,n=x;return console.log(void 0===n.Themes?"Themes not found":"Themes loaded"),t.CodifyText=function(t){e.LoggingUtils.Trace("ecf-function-codify"),o.AddinUtils.TryCodifying(),null==t||t.completed()},t.HighlightHtml=function(t){e.LoggingUtils.Trace("ecf-function-highlight"),o.AddinUtils.TryHighlighting(),null==t||t.completed()},t}())}();